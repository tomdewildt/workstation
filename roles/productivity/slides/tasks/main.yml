---
- name: Install slides (linux)
  become: true
  when: ansible_distribution == 'Debian' or ansible_distribution == 'Ubuntu'
  block:
    - name: Read browser desktop file (linux)
      ansible.builtin.slurp:
        src: /usr/share/applications/{{ browser.default }}.desktop
      register: browser_file

    - name: Extract browser executable (linux)
      ansible.builtin.set_fact:
        browser_executable: "{{ browser_file.content | b64decode | regex_search('^Exec=([^ ]*).*', '\\1', multiline=True) | first }}"

    - name: Ensure icons folder exists (linux)
      ansible.builtin.file:
        path: /usr/share/applications/icons
        state: directory
        mode: "0755"

    - name: Download slides icon (linux)
      ansible.builtin.get_url:
        url: https://raw.githubusercontent.com/homarr-labs/dashboard-icons/refs/heads/main/png/google-slides.png
        dest: /usr/share/applications/icons/google-slides.png
        owner: root
        group: root
        mode: "0644"

    - name: Copy slides desktop file (linux)
      ansible.builtin.template:
        src: templates/slides/slides.desktop.j2
        dest: /usr/share/applications/google-slides.desktop
        owner: root
        group: root
        mode: "0644"
# TODO: install slides (macos)
