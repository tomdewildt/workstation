---
- name: Add node key
  ansible.builtin.apt_key:
    url: https://deb.nodesource.com/gpgkey/nodesource.gpg.key
    keyring: /etc/apt/trusted.gpg.d/nodesource.gpg
    state: present

- name: Add node repository
  ansible.builtin.apt_repository:
    repo: deb [arch=amd64] https://deb.nodesource.com/node_{{ javascript.version }} focal main
    filename: nodesource
    state: present

- name: Install node
  ansible.builtin.apt:
    name: nodejs
    update_cache: true
    state: latest

- name: Install packages
  community.general.npm:
    name: "{{ item }}"
    unsafe_perm: true
    global: true
    state: latest
  with_items: "{{ javascript.packages }}"
